# 專案簡報與產品需求文件 (Project Brief & PRD) - 智慧旅遊行程規劃器

---

**文件版本 (Document Version):** `v1.0`
**最後更新 (Last Updated):** `2025-09-24`
**主要作者 (Lead Author):** `Gemini`
**審核者 (Reviewers):** `使用者`
**狀態 (Status):** `草稿 (Draft)`

---

## 目錄 (Table of Contents)

1.  [專案總覽 (Project Overview)](#第-1-部分專案總覽-project-overview)
2.  [商業目標 (Business Objectives) - 「為何做？」](#第-2-部分商業目標-business-objectives---為何做)
3.  [使用者故事與允收標準 (User Stories & UAT) - 「做什麼？」](#第-3-部分使用者故事與允收標準-user-stories--uat---做什麼)
4.  [範圍與限制 (Scope & Constraints)](#第-4-部分範圍與限制-scope--constraints)
5.  [待辦問題與決策 (Open Questions & Decisions)](#第-5-部分待辦問題與決策-open-questions--decisions)

---

**目的**: 本文件旨在定義專案的「為何」與「為誰」，為整個專案設定最高層次的目標和邊界。它是所有後續設計、開發與測試工作的唯一事實來源 (Single Source of Truth)。

---

## 第 1 部分：專案總覽 (Project Overview)

| 區塊 | 內容 |
| :--- | :--- |
| **專案名稱** | 智慧旅遊行程規劃器 (Intelligent Travel Itinerary Planner) |
| **狀態** | 規劃中 |
| **目標發布日期** | 2025-10-15 (基於三週開發里程碑) |
| **核心團隊** | PM: 使用者<br>Lead Engineer: Gemini |

---

## 第 2 部分：商業目標 (Business Objectives) - 「為何做？」

*在投入資源前，我們必須清晰地定義問題、目標使用者和商業價值，避免開發出無人需要的產品。*

| 區塊 | 內容 |
| :--- | :--- |
| **1. 背景與痛點** | 現有旅遊規劃方式過於繁瑣，使用者需在多個平台間切換，手動查詢景點、餐廳的營業時間與評價，並自行估算交通，過程耗時且容易出錯。市面上的工具普遍缺乏彈性，難以透過簡單的對話來滿足個人化的動態偏好。 |
| **2. 策略契合度** | 本專案旨在打造一款創新的 AI 原生旅遊規劃產品，透過流暢的對話式體驗，提供高度個人化且「可行」的行程方案，建立在智慧旅遊領域的技術領先地位。 |
| **3. 成功指標 (Success Metrics)** | 我們如何衡量成功？定義 1-3 個可量化的關鍵績效指標 (KPI)。<br> - **主要指標**: **規劃成功率 > 80%** (使用者對話最終能產出一個完整可行行程的比例)。<br> - **次要指標**: **使用者滿意度 < 2** (每份行程草案的平均使用者手動修改次數，次數越少代表初始推薦越精準)。<br> - **次要指標**: **對話效率 < 5** (從使用者發起請求到產出第一份行程草案的平均對話輪次)。 |

---

## 第 3 部分：使用者故事與允收標準 (User Stories & UAT) - 「做什麼？」

*這是連接「商業需求」與「技術實現」的橋樑。每個使用者故事都應直接對應到下一個階段的 BDD 情境。*

### 核心史詩 (Core Epic): 對話式行程規劃 (Conversational Itinerary Planning)

| 使用者故事 ID | 描述 (As a, I want to, so that) | 核心允收標準 (UAT) | 連結至 BDD 文件 |
| :--- | :--- | :--- | :--- |
| **US-001** | **As a** 旅遊規劃者,<br>**I want to** 透過自然語言描述我的旅遊需求（如天數、地點、偏好主題、預算等）,<br>**so that** 系統能快速理解並為我生成一份個人化的行程草案。 | 1. 使用者輸入「我想去宜蘭玩三天兩夜，喜歡大自然和美食，預算兩人一天3000」。<br>2. 系統能正確解析出 Story JSON 中的所有槽位。<br>3. 系統基於解析出的條件，提出一份符合邏輯的行程草案。 | `planning_scenarios.feature` |
| **US-002** | **As a** 旅遊規劃者,<br>**I want to** 對已生成的行程草案，用口語化的方式提出修改（如「刪掉第二天下午的點」、「幫我換個便宜點的餐廳」）,<br>**so that** 我可以輕鬆地微調行程直到滿意為止。 | 1. 使用者對行程提出「第二天不要去那個地方」。<br>2. 系統能透過 Edit-Plan DSL 正確解析為 `{'''op''':'''DROP''','''target''':{'''day''':2,...}}`。<br>3. 系統提供一份更新後的行程，或在指令模糊時提出澄清問題。 | `feedback_scenarios.feature` |
| **US-003** | **As a** 旅遊者,<br>**I want to** 確保行程中的每個地點都在其營業時間內，且景點間的交通時間被合理計算並納入緩衝,<br>**so that** 我可以安心地照著行程走，不會遇到店家關門或時間來不及的窘境。 | 1. 產出行程中，任一景點的預計到達 (ETA) 和離開 (ETD) 時間都必須在其營業時間範圍內。<br>2. 每日的總行程時間（停留時間 + 交通時間）不可超過使用者設定的每日時間窗。<br>3. 交通時間已根據時段與區域係數加入緩衝。 | `feasibility_scenarios.feature` |

---

## 第 4 部分：範圍與限制 (Scope & Constraints)

*明確定義邊界是專案成功的關鍵。這為 LLM 生成程式碼提供了最重要的「護欄」。*

| 區塊 | 內容 |
| :--- | :--- |
| **功能性需求 (In Scope)** | - 自然語言需求解析 (NLU to Story JSON)<br>- 混合式景點檢索（結構化過濾 + 語義搜索）<br>- 基於時間窗與交通時間的行程規劃（Greedy + 2-opt）<br>- 對話式行程修改（基於 Edit-Plan DSL）<br>- POI 品質監控與回饋閉環 |
| **非功能性需求 (NFRs)** | - **性能**: 首次行程建議 API (`/v1/itinerary:propose`) P95 延遲 < 5秒。<br>- **安全性**: 不收集或儲存使用者個人身份資訊（PII），使用者偏好僅儲存於 Session 範圍。<br>- **可用性**: MVP 階段的 POI 資料範圍先以「宜蘭縣」作為熱區樣本。 |
| **不做什麼 (Out of Scope)** | - 全域最優解（例如整合 Google OR-Tools）。<br>- 即時票務、訂位、訂房整合。<br>- 全台灣或其他地區的 POI 資料覆蓋。<br>- 完整的圖形化使用者介面（GUI）。 |
| **假設與依賴** | - **假設**: 使用者能清晰地表達其核心旅遊偏好。<br>- **依賴**: 依賴外部 OSRM 服務進行路網時間計算。<br>- **依賴**: 依賴外部 LLM API 進行自然語言的理解與生成。 |

---

## 第 5 部分：待辦問題與決策 (Open Questions & Decisions)

*記錄在討論過程中出現的、需要進一步澄清的問題或已做出的重要決策。*

| 問題/決策 ID | 描述 | 狀態 | 負責人 |
| :--- | :--- | :--- | :--- |
| **Q-001** | LLM API 的最終選型（GPT-4, Claude, Gemini 等）及其成本控制策略？ | 待討論 | 使用者 |
| **D-001** | MVP 階段的資料範圍確定為「宜蘭縣」。 | 已決定 | 使用者 |
| **D-002** | 後端 API 框架確定為 Python/FastAPI。 | 已決定 | 使用者 |
| **D-003** | 對話式修改採用「規則優先 + LLM 解析至 DSL」的混合策略。 | 已決定 | 使用者 |
| **D-004** | 部署方式採用 Docker Compose 統一編排所有服務。 | 已決定 | 使用者 |

